import { Callout } from "nextra-theme-docs";

# Aper√ßu

Il existe diverses approches que les impl√©menteurs peuvent utiliser pour configurer leurs instances O3. Celles-ci incluent:

- Les m√©tadonn√©es backend et la configuration (via Initializer)
- La configuration des modules frontend individuels
- La configuration au niveau de la distribution

## Configuration des m√©tadonn√©es et des param√®tres backend

Les m√©tadonn√©es backend et les param√®tres de configuration sont charg√©s via le [module initializer](https://github.com/mekomsolutions/openmrs-module-initializer) dans O3. Le module initializer, ou Iniz en abr√©g√©, est un module qui permet aux impl√©menteurs de charger des m√©tadonn√©es (concepts, lieux, formulaires, etc.) et des param√®tres de configuration (propri√©t√©s globales) dans leurs instances OpenMRS √† travers des fichiers de configuration.

<Callout emoji="üé•" type="info">
  **Nouveau sur Initializer ?** Regardez cette [vid√©o d'introduction](https://www.youtube.com/watch?v=Nerhs2ANq98) qui explique ce que sont les fichiers de configuration Initializer, pourquoi les utiliser, et pr√©sente des exemples pratiques pour les lieux, les m√©dicaments, les formulaires et les traductions.
</Callout>

**Pourquoi utiliser les fichiers de configuration Initializer ?**

Utiliser les fichiers de configuration Initializer au lieu de tout configurer via l'interface d'administration offre plusieurs avantages :
- **Stabilit√©** - La configuration est d√©finie dans des fichiers plut√¥t que de d√©pendre d'une configuration manuelle via l'interface
- **Contr√¥le de version** - Les fichiers de configuration peuvent √™tre suivis dans Git, rendant les changements auditable et r√©versibles
- **R√©utilisabilit√©** - La m√™me configuration peut √™tre facilement d√©ploy√©e sur plusieurs sites dans une distribution
- **Automatisation** - Les m√©tadonn√©es sont automatiquement charg√©es au d√©marrage, r√©duisant le travail de configuration manuelle

**Important** : Le module Initializer prend en charge plusieurs formats de fichiers selon le domaine :
- **Fichiers CSV** - Utilis√©s pour la plupart des types de m√©tadonn√©es (concepts, lieux, m√©dicaments, types d'attributs de personne, etc.)
- **Fichiers JSON** - Utilis√©s pour les formulaires, les formulaires Bahmni, les traductions de formulaires et certains autres domaines
- **Fichiers XML** - Utilis√©s pour les propri√©t√©s globales et certains formats h√©rit√©s

Les m√©tadonn√©es peuvent √™tre fournies de trois fa√ßons :

1. **Packages de contenu** - Art√©facts Maven qui regroupent les m√©tadonn√©es sous forme de fichiers de configuration. Ceux-ci sont r√©f√©renc√©s dans `distro.properties` et charg√©s automatiquement au d√©marrage du backend. Les packages de contenu peuvent inclure √† la fois des m√©tadonn√©es backend (charg√©es par le module Initializer) et des fichiers de configuration frontend (situ√©s dans `configuration/frontend_configuration/config.json`). L'application de r√©f√©rence utilise deux packages de contenu :
   - [`openmrs-content-referenceapplication`](https://github.com/openmrs/openmrs-content-referenceapplication) - M√©tadonn√©es de base essentielles requises pour ex√©cuter O3 (par exemple, le tag "Login Location", les ensembles de concepts CIEL)
   - [`openmrs-content-referenceapplication-demo`](https://github.com/openmrs/openmrs-content-referenceapplication-demo) - M√©tadonn√©es de d√©monstration/kit de d√©marrage optionnelles (laboratoires, diagnostics, m√©dicaments, etc.) utiles pour les d√©mos et les d√©marrages rapides. Ce package inclut √©galement une configuration frontend pour la configuration des emplacements d'extensions.

2. **R√©pertoire de configuration de la distribution** - Fichiers de configuration dans le r√©pertoire `distro/configuration` de votre d√©p√¥t de distribution. Ces fichiers sont empaquet√©s dans le WAR backend pendant la construction et charg√©s par Initializer √† l'ex√©cution. Les fichiers sont organis√©s par domaine (par exemple, `configuration/concepts/`, `configuration/locations/`). Les fichiers de configuration de l'application de r√©f√©rence se trouvent [ici](https://github.com/openmrs/openmrs-distro-referenceapplication/tree/main/distro/configuration).

3. **R√©pertoire de donn√©es d'application** - Fichiers de configuration plac√©s dans le r√©pertoire de donn√©es d'application d'OpenMRS (g√©n√©ralement `/openmrs/data/configuration/` ou `~/.OpenMRS/configuration/`). Cela permet des mises √† jour √† l'ex√©cution sans reconstruction. Le module Initializer traite les fichiers de ce r√©pertoire s'il existe, ce qui est utile pour les mises √† jour de m√©tadonn√©es post-d√©ploiement.

**Ordre de chargement et pr√©c√©dence** :
1. **Packages de contenu** sont charg√©s en premier (dans l'ordre sp√©cifi√© dans `distro.properties`)
2. **R√©pertoire de configuration de la distribution** - Les fichiers sont charg√©s ensuite (peuvent remplacer les packages de contenu)
3. **R√©pertoire de donn√©es d'application** - Les fichiers sont charg√©s en dernier (peuvent remplacer √† la fois les packages de contenu et la configuration de la distribution)

**Important** : 
- Les modifications des fichiers dans `distro/configuration` n√©cessitent une reconstruction du WAR backend pour prendre effet
- Les modifications des fichiers dans le r√©pertoire de donn√©es d'application prennent effet au red√©marrage suivant du backend (pas de reconstruction n√©cessaire)
- Le module Initializer utilise des sommes de contr√¥le pour suivre les changements de fichiers‚Äîles fichiers ne sont retrait√©s que si leur somme de contr√¥le change, am√©liorant les performances

**Note sp√©cifique √† Docker** : Dans les d√©ploiements Docker, les fichiers `distro/configuration` sont int√©gr√©s dans l'image Docker backend pendant la construction. Pour mettre √† jour les m√©tadonn√©es sans reconstruire, vous pouvez :
- Monter le r√©pertoire de donn√©es d'application comme volume et y placer les fichiers de configuration
- Ou reconstruire l'image backend (voir le guide [Configuration d'une instance O3](/docs/recipes/set-up-o3-instance#updating-metadata))

Les d√©ploiements SDK peuvent mettre √† jour soit `distro/configuration` (n√©cessite une reconstruction WAR) soit le r√©pertoire de donn√©es d'application (n√©cessite uniquement un red√©marrage).

Le module initializer prend en charge le chargement d'une grande vari√©t√© de types de donn√©es et de m√©tadonn√©es, incluant mais sans s'y limiter :

- **Lieux** - D√©finir la hi√©rarchie des installations, les lieux de connexion et les tags de lieu
- **M√©dicaments** - Cr√©er des entr√©es de formulaires avec concepts, formes (comprim√©, injection, etc.) et dosages
- **Concepts** - Charger des dictionnaires de concepts et des ensembles de concepts
- **Formulaires** - D√©ployer des d√©finitions de formulaires (y compris les formulaires construits dans Form Builder) sous forme de fichiers JSON
- **Traductions de formulaires** - Fournir des traductions pour les libell√©s de formulaires dans plusieurs langues
- **Types d'attributs de personne** - D√©finir des attributs de patient personnalis√©s
- **Propri√©t√©s globales** - D√©finir des valeurs de configuration √† l'√©chelle du syst√®me (voir "Configuration des propri√©t√©s globales" ci-dessous)
- **Types de rencontre** - D√©finir les types de rencontres cliniques
- **Types de visite** - Configurer les classifications de visite
- **Programmes** - Configurer les programmes de patients (par exemple, soins VIH, traitement TB)
- **Flux de travail de programme** - D√©finir les √©tats de flux de travail de programme
- **R√¥les et privil√®ges** - Configurer les r√¥les et permissions des utilisateurs

### Configuration des propri√©t√©s globales

Les propri√©t√©s globales sont des **param√®tres de configuration** (pas des m√©tadonn√©es) qui sont stock√©s dans la base de donn√©es OpenMRS sous forme de paires cl√©-valeur. Elles vous permettent de configurer des param√®tres √† l'√©chelle du syst√®me sans modifier le code. Elles fonctionnent de mani√®re similaire aux variables d'environnement, permettant des ajustements dynamiques du comportement du syst√®me.

**Note** : Bien que les propri√©t√©s globales soient charg√©es via le module Initializer (le m√™me m√©canisme utilis√© pour les m√©tadonn√©es), ce sont des param√®tres de configuration plut√¥t que des m√©tadonn√©es. Les m√©tadonn√©es repr√©sentent des structures de donn√©es cliniques (concepts, lieux, formulaires), tandis que les propri√©t√©s globales contr√¥lent le comportement du syst√®me et la configuration des modules.

**Utilisations courantes des propri√©t√©s globales** :
- **Configuration syst√®me** - Ajuster les types de rencontre par d√©faut, les formats d'identifiants de patients et d'autres param√®tres √† l'√©chelle du syst√®me
- **Comportement des modules** - Configurer le comportement de modules backend sp√©cifiques
- **Optimisation des performances** - Optimiser les performances du syst√®me en modifiant les propri√©t√©s li√©es aux comportements de recherche, √† la mise en cache et √† d'autres param√®tres li√©s aux performances
- **Param√®tres d'int√©gration** - Configurer les int√©grations de syst√®mes externes et les points de terminaison d'API

**Comment configurer les propri√©t√©s globales** :

Les propri√©t√©s globales sont configur√©es √† l'aide de fichiers XML dans le module Initializer. Placez votre fichier XML de propri√©t√©s globales dans l'un de ces emplacements :

1. **Packages de contenu** - Dans le r√©pertoire `configuration/globalproperties/`
2. **R√©pertoire de configuration de la distribution** - Dans le r√©pertoire `distro/configuration/globalproperties/`
3. **R√©pertoire de donn√©es d'application** - Dans `/openmrs/data/configuration/globalproperties/` ou `~/.OpenMRS/configuration/globalproperties/`

**Format de fichier XML** :

```xml
<?xml version="1.0" encoding="UTF-8"?>
<globalProperties>
  <globalProperty>
    <property>property.name.here</property>
    <value>property value</value>
    <description>Description de ce que fait cette propri√©t√©</description>
  </globalProperty>
  <globalProperty>
    <property>another.property.name</property>
    <value>another value</value>
  </globalProperty>
</globalProperties>
```

**Exemples de propri√©t√©s globales** :

```xml
<?xml version="1.0" encoding="UTF-8"?>
<globalProperties>
  <globalProperty>
    <property>patientmatching.strategy</property>
    <value>probabilistic</value>
    <description>Strat√©gie de correspondance des patients (probabiliste ou d√©terministe)</description>
  </globalProperty>
  <globalProperty>
    <property>default.encounter.type</property>
    <value>67a71486-1a54-468f-ac3e-7091a9a79584</value>
    <description>UUID du type de rencontre par d√©faut</description>
  </globalProperty>
</globalProperties>
```

**Notes importantes** :
- Les propri√©t√©s globales peuvent √™tre mises √† jour √† l'ex√©cution via l'interface d'administration OpenMRS (Param√®tres avanc√©s), mais l'utilisation de fichiers Initializer garantit qu'elles sont contr√¥l√©es par version et appliqu√©es automatiquement lors du d√©ploiement
- Les modifications des propri√©t√©s globales dans `distro/configuration` n√©cessitent une reconstruction du WAR backend
- Les modifications des propri√©t√©s globales dans le r√©pertoire de donn√©es d'application prennent effet au prochain red√©marrage du backend (pas de reconstruction n√©cessaire)
- Pour une liste compl√®te des propri√©t√©s globales disponibles, consultez la [documentation des propri√©t√©s globales OpenMRS](https://wiki.openmrs.org/display/docs/Global+Properties) ou v√©rifiez la documentation pour des modules sp√©cifiques

<Callout emoji="üí°" type="info">
  **Gestion des dictionnaires de concepts** : L'approche recommand√©e pour g√©rer les dictionnaires de concepts dans OpenMRS est de cr√©er votre propre organisation et ressources dans [Open Concept Lab (OCL)](https://app.openconceptlab.org/). Cela vous permet de standardiser la gestion des concepts dans votre impl√©mentation, de cr√©er et maintenir vos propres ensembles de concepts, et de les exporter sous forme de fichiers ZIP pour inclusion dans vos packages de contenu. Le [dictionnaire CIEL](https://app.openconceptlab.org/#/orgs/CIEL/sources/CIEL/) est le dictionnaire de concepts standard contenant des milliers de concepts cliniques‚Äîvous pouvez r√©f√©rencer les concepts CIEL dans vos ressources OCL ou cr√©er des concepts sp√©cifiques √† votre organisation. Lors de la configuration de m√©dicaments, de formulaires ou d'autres m√©tadonn√©es, vous pouvez rechercher dans OCL pour trouver les UUID de concepts et g√©rer vos ensembles de concepts via votre organisation OCL.
</Callout>

**Organisation des fichiers** : Les fichiers de configuration sont organis√©s par domaine dans des sous-r√©pertoires (par exemple, `configuration/concepts/`, `configuration/locations/`, `configuration/drugs/`, `configuration/ampathforms/`). Chaque domaine a des exigences de format de fichier et des conventions de nommage document√©es dans le README d'Initializer. Les fichiers peuvent √™tre organis√©s dans des structures de r√©pertoires imbriqu√©es, et Initializer les traitera par ordre alphab√©tique si aucun ordre explicite n'est sp√©cifi√©.

**Exemples pratiques** :
- **CSV des lieux** - Chaque ligne d√©finit un lieu avec UUID, nom, description, lieu parent et indicateurs (par exemple, s'il s'agit d'un lieu de connexion)
- **CSV des m√©dicaments** - Chaque ligne cr√©e une entr√©e de m√©dicament avec UUID, nom, UUID de concept (de CIEL/OCL), concept de forme et dosage (par exemple, "Parac√©tamol 500mg comprim√©")
- **JSON des formulaires** - Les formulaires construits dans Form Builder peuvent √™tre export√©s en JSON et plac√©s dans le r√©pertoire de configuration des formulaires
- **Traductions de formulaires** - Des fichiers de traduction s√©par√©s mappent les textes des libell√©s de formulaires vers des cha√Ænes traduites pour diff√©rentes langues

**Contr√¥le √† l'ex√©cution** : Le module Initializer fournit des propri√©t√©s √† l'ex√©cution qui vous permettent de :
- Activer ou d√©sactiver des domaines sp√©cifiques pendant l'initialisation
- Contr√¥ler le comportement de chargement (par exemple, √©chec rapide vs. continuer en cas d'erreurs)
- Configurer la verbosit√© des journaux
- Filtrer les fichiers en utilisant des mod√®les g√©n√©riques

Pour des informations d√©taill√©es sur les formats de fichiers, les conventions de nommage, les exigences sp√©cifiques au domaine et les propri√©t√©s √† l'ex√©cution, consultez le [README du module Initializer](https://github.com/mekomsolutions/openmrs-module-initializer#openmrs-initializer-module). Le README inclut une sous-documentation sp√©cifique pour chaque type de fichier de configuration (par exemple, CSV des m√©dicaments, lieux, traductions de formulaires).

**Obtenir de l'aide** : Si vous avez des questions ou rencontrez des probl√®mes avec la configuration Initializer, la communaut√© OpenMRS recommande de publier sur le [forum OpenMRS Talk](https://talk.openmrs.org/) et de taguer votre sujet avec "initializer" pour que les membres de la communaut√© puissent aider.

Les propri√©t√©s globales sont des paires cl√©-valeur stock√©es dans la base de donn√©es OpenMRS qui vous permettent de configurer des param√®tres √† l'√©chelle du syst√®me sans modifier le code. Elles fonctionnent de mani√®re similaire aux variables d'environnement, permettant des ajustements dynamiques du comportement du syst√®me.

**Utilisations courantes des propri√©t√©s globales** :
- **Configuration syst√®me** - Ajuster les types de rencontre par d√©faut, les formats d'identifiants de patients et d'autres param√®tres √† l'√©chelle du syst√®me
- **Comportement des modules** - Configurer le comportement de modules backend sp√©cifiques
- **Optimisation des performances** - Optimiser les performances du syst√®me en modifiant les propri√©t√©s li√©es aux comportements de recherche, √† la mise en cache et √† d'autres param√®tres li√©s aux performances
- **Param√®tres d'int√©gration** - Configurer les int√©grations de syst√®mes externes et les points de terminaison d'API

**Comment configurer les propri√©t√©s globales** :

Les propri√©t√©s globales sont configur√©es √† l'aide de fichiers XML dans le module Initializer. Placez votre fichier XML de propri√©t√©s globales dans l'un de ces emplacements :

1. **Packages de contenu** - Dans le r√©pertoire `configuration/globalproperties/`
2. **R√©pertoire de configuration de la distribution** - Dans le r√©pertoire `distro/configuration/globalproperties/`
3. **R√©pertoire de donn√©es d'application** - Dans `/openmrs/data/configuration/globalproperties/` ou `~/.OpenMRS/configuration/globalproperties/`

**Format de fichier XML** :

```xml
<?xml version="1.0" encoding="UTF-8"?>
<globalProperties>
  <globalProperty>
    <property>property.name.here</property>
    <value>property value</value>
    <description>Description de ce que fait cette propri√©t√©</description>
  </globalProperty>
  <globalProperty>
    <property>another.property.name</property>
    <value>another value</value>
  </globalProperty>
</globalProperties>
```

**Exemples de propri√©t√©s globales** :

```xml
<?xml version="1.0" encoding="UTF-8"?>
<globalProperties>
  <globalProperty>
    <property>patientmatching.strategy</property>
    <value>probabilistic</value>
    <description>Strat√©gie de correspondance des patients (probabiliste ou d√©terministe)</description>
  </globalProperty>
  <globalProperty>
    <property>default.encounter.type</property>
    <value>67a71486-1a54-468f-ac3e-7091a9a79584</value>
    <description>UUID du type de rencontre par d√©faut</description>
  </globalProperty>
</globalProperties>
```

**Notes importantes** :
- Les propri√©t√©s globales peuvent √™tre mises √† jour √† l'ex√©cution via l'interface d'administration OpenMRS (Param√®tres avanc√©s), mais l'utilisation de fichiers Initializer garantit qu'elles sont contr√¥l√©es par version et appliqu√©es automatiquement lors du d√©ploiement
- Les modifications des propri√©t√©s globales dans `distro/configuration` n√©cessitent une reconstruction du WAR backend
- Les modifications des propri√©t√©s globales dans le r√©pertoire de donn√©es d'application prennent effet au prochain red√©marrage du backend (pas de reconstruction n√©cessaire)
- Pour une liste compl√®te des propri√©t√©s globales disponibles, consultez la [documentation des propri√©t√©s globales OpenMRS](https://wiki.openmrs.org/display/docs/Global+Properties) ou v√©rifiez la documentation pour des modules sp√©cifiques

## Configuration des modules frontend individuels

La configuration par application est disponible dans O3 via le [syst√®me de configuration](/docs/configuration-system) int√©gr√©. Chaque module frontend peut d√©finir son propre sch√©ma de configuration dans un fichier `config-schema.ts` √† l'int√©rieur de son r√©pertoire `src`. L'extrait suivant est tir√© du config-schema du module frontend Programs :

```tsx filename="src/config-schema.ts"
import { Type } from '@openmrs/esm-framework';

export const configSchema = {
  hideAddProgramButton: {
    _type: Type.Boolean,
    _default: false,
  },
  showProgramStatusField: {
    _type: Type.Boolean,
    _description:
      'Whether to show the Program status field in the Record program enrollment and Edit program enrollment forms. If set to true, the `Program status` field is displayed in the Programs datatable',
    _default: false,
  },
};

export interface ConfigObject {
  hideAddProgramButton: boolean;
  showProgramStatusField: boolean;
}
```

Les propri√©t√©s sp√©cifi√©es dans le sch√©ma de configuration permettent aux impl√©menteurs d'adapter le comportement du module √† leurs besoins. Le syst√®me de configuration permet √©galement aux impl√©menteurs de sp√©cifier des valeurs par d√©faut pour les diverses propri√©t√©s de configuration.

Les impl√©menteurs peuvent apporter des modifications aux configurations des modules frontend via le panneau int√©gr√© d'outils pour les impl√©menteurs. Une fois connect√© √† O3, un clic sur la fl√®che centr√©e en bas de l'√©cran affichera les outils de l'impl√©menteur. Vous pouvez √©galement cliquer sur l'ic√¥ne d'engrenage dans la barre de navigation. Une fois ouvert, vous pouvez rechercher des propri√©t√©s de configuration en les cherchant et les modifier √† la vol√©e. Notez que toute modification apport√©e √† la configuration via les outils de l'impl√©menteur sera perdue une fois que vous rafra√Æchirez la page. Pour apporter des modifications permanentes √† la configuration, vous devrez valider ces changements dans la configuration de votre distribution. Les outils de l'impl√©menteur vous permettent de t√©l√©charger un fichier de configuration temporaire contenant vos modifications en cliquant sur le bouton `T√©l√©charger la config`.

G√©n√©ralement, vous devrez apporter plusieurs substitutions de configuration √† divers modules frontend diff√©rents. L'approche standard est de cr√©er un fichier de configuration JSON qui est accessible via HTTP/HTTPS sur votre serveur. Vous pouvez alors pointer votre SPA vers ce fichier de configuration en sp√©cifiant son URL dans le tableau `configUrls` du fichier de configuration de g√©n√©ration de la SPA (`spa-build-config.json`). Alternativement, vous pouvez inclure une configuration frontend dans les packages de contenu (voir "Configuration frontend des packages de contenu" ci-dessous).

**Distinction critique** : 
- **Modifier `spa-build-config.json`** n√©cessite une reconstruction de la SPA frontend
- **Modifier les fichiers de configuration r√©f√©renc√©s par `configUrls`** ne n√©cessite PAS de reconstruction‚Äîil suffit de mettre √† jour le fichier et de rafra√Æchir le navigateur

Cela signifie que vous pouvez mettre √† jour les configurations de modules √† l'ex√©cution sans reconstruire, tant que les fichiers de configuration sont accessibles via HTTP/HTTPS.

**Structure du fichier de configuration :**

Chaque cl√© dans le fichier de configuration correspond √† un nom de module frontend (par exemple, `@openmrs/esm-patient-chart-app`). La valeur de chaque cl√© est un objet contenant les propri√©t√©s de configuration que vous souhaitez substituer pour ce module. Ces propri√©t√©s correspondent aux propri√©t√©s d√©finies dans le sch√©ma de configuration du module.

**Exemple de fichier de configuration :**

```json
{
  "@openmrs/esm-patient-chart-app": {
    "showRecommendedVisitTypeTab": true,
    "showAllEncountersTab": false
  },
  "@openmrs/esm-primary-navigation-app": {
    "logo": {
      "src": "${openmrsSpaBase}/assets/my-logo.svg",
      "alt": "Logo de mon organisation"
    }
  }
}
```

**Exemples de fichiers de configuration :**
- L'application de r√©f√©rence inclut un fichier de configuration exemple √† `frontend/config-core_demo.json` (voir [ici](https://github.com/openmrs/openmrs-distro-referenceapplication/blob/main/frontend/config-core_demo.json)). Ce fichier est copi√© dans l'image Docker frontend et servi √† `/openmrs/spa/config-core_demo.json` par d√©faut.
- Un autre exemple de fichier de configuration r√©el est le [fichier de configuration Ozone Cambodia](https://github.com/mekomsolutions/ozone-distro-cambodia/blob/main/base/configs/openmrs/frontend_config/ozone-frontend-config.json).

**Comment les fichiers de configuration sont charg√©s :**

Les fichiers de configuration sp√©cifi√©s dans `configUrls` sont r√©cup√©r√©s √† l'ex√©cution (lors du chargement de la SPA), pas pendant le processus de construction. Ils sont charg√©s s√©quentiellement dans l'ordre sp√©cifi√© dans le tableau. Lors de la fusion des configurations, les fichiers ult√©rieurs remplacent les fichiers ant√©rieurs‚Äîdonc le dernier fichier du tableau a la pr√©c√©dence la plus √©lev√©e parmi les fichiers de configuration. Si un fichier de configuration √©choue √† charger, une erreur est enregistr√©e dans la console, mais l'application continue de fonctionner avec les fichiers de configuration restants et les valeurs par d√©faut.

**Configuration frontend des packages de contenu :**

Les packages de contenu peuvent inclure des fichiers de configuration frontend √† `configuration/frontend_configuration/config.json`. Ces fichiers fournissent des substitutions de configuration au niveau de la distribution. Actuellement, ces fichiers doivent √™tre extraits manuellement des packages de contenu et rendus accessibles via HTTP/HTTPS (soit en les servant depuis votre serveur web soit en ajoutant leurs URLs √† `configUrls`). √Ä l'avenir, le backend pourra automatiquement extraire et servir ces fichiers.

**Note** : Le package de contenu de d√©monstration (`openmrs-content-referenceapplication-demo`) inclut un fichier de configuration frontend qui configure les emplacements d'extensions. Pour l'utiliser, extrayez `configuration/frontend_configuration/config.json` du package de contenu et servez-le via HTTP/HTTPS, puis ajoutez son URL √† `configUrls` dans `spa-build-config.json`.

**Pr√©c√©dence de configuration** (du plus √©lev√© au plus bas) :
1. **Configuration temporaire** (depuis les outils d'impl√©menteur) ‚Äî pr√©c√©dence la plus √©lev√©e, remplace toutes les autres sources
2. **Configurations frontend des packages de contenu** (depuis `configuration/frontend_configuration/config.json` dans les packages de contenu, lorsqu'extraits manuellement et ajout√©s √† `configUrls`)
3. **Fichiers de configuration** (depuis `configUrls`, charg√©s s√©quentiellement‚Äîle dernier fichier du tableau remplace les fichiers ant√©rieurs)
4. **Valeurs par d√©faut du sch√©ma** (valeurs `_default` dans les sch√©mas de configuration) ‚Äî pr√©c√©dence la plus basse, utilis√©es lorsqu'aucune autre source ne fournit de valeur

**Note sur les configurations frontend des packages de contenu** : Les configurations frontend des packages de contenu (depuis `configuration/frontend_configuration/config.json`) doivent actuellement √™tre extraites manuellement et ajout√©es √† `configUrls` pour √™tre utilis√©es. Lorsqu'elles sont ajout√©es √† `configUrls`, elles sont trait√©es comme des fichiers de configuration r√©guliers et suivent les m√™mes r√®gles de pr√©c√©dence‚Äîplacez-les plus t√¥t dans le tableau pour √™tre remplac√©es par d'autres fichiers de configuration, ou plus tard pour remplacer d'autres fichiers de configuration. La conception pr√©vue est que les configurations frontend des packages de contenu soient automatiquement charg√©es avec une pr√©c√©dence plus √©lev√©e que les fichiers de configuration r√©guliers, mais cette fonctionnalit√© n'est pas encore impl√©ment√©e.

**Configuration des feature flags :**

Les feature flags peuvent √™tre activ√©s via les fichiers de configuration (en plus de les basculer dans l'interface des outils de mise en ≈ìuvre). Pour activer les feature flags pour tous les utilisateurs, ajoutez-les √† la configuration de l'app shell :

```json
{
  "@openmrs/esm-app-shell": {
    "Enabled feature flags": ["feature-flag-name-1", "feature-flag-name-2"]
  }
}
```

Les feature flags configur√©s de cette mani√®re sont activ√©s pour tous les utilisateurs, contrairement au bouton des outils de mise en ≈ìuvre qui n'affecte que la session du navigateur de l'utilisateur actuel. Notez que les feature flags doivent d'abord √™tre enregistr√©s par le module qui les d√©finit (via `registerFeatureFlag` dans le code) avant de pouvoir √™tre activ√©s via la configuration.

**Important** : Les fichiers de configuration doivent √™tre accessibles via HTTP/HTTPS. La SPA tentera de les r√©cup√©rer en utilisant `fetch()`, donc ils doivent √™tre servis par un serveur web (nginx, Apache, etc.) ou un CDN. Les chemins de fichiers locaux ne fonctionneront pas.

**Consid√©rations sp√©cifiques √† Docker :**

Si vous utilisez Docker, il existe plusieurs fa√ßons de servir les fichiers de configuration :

1. **Montages de volumes** (recommand√© pour des mises √† jour faciles) : Montez les fichiers de configuration comme volumes dans votre `docker-compose.yml`. Cela vous permet de mettre √† jour les fichiers de configuration sans reconstruire les conteneurs :
   ```yaml
   frontend:
     volumes:
       - ./config/my-config.json:/usr/share/nginx/html/config/my-config.json
   ```
   Puis r√©f√©rencez-le dans `spa-build-config.json` comme `${openmrsSpaBase}/config/my-config.json`.

2. **Copier dans le conteneur** (n√©cessite une reconstruction) : Copiez les fichiers de configuration dans le conteneur frontend pendant la construction en utilisant la commande `COPY` du Dockerfile. Cela int√®gre la configuration dans l'image.

3. **Service gateway/nginx** : Servez les fichiers de configuration depuis le conteneur gateway (nginx), qui peut proxy les requ√™tes vers les fichiers de configuration stock√©s ailleurs.

4. **Variables d'environnement** : D√©finissez `SPA_CONFIG_URLS` dans la section environnement de votre `docker-compose.yml` pour remplacer les URLs de configuration √† l'ex√©cution sans reconstruire. Par exemple :
   ```yaml
   frontend:
     environment:
       SPA_CONFIG_URLS: /openmrs/spa/config-core_demo.json
   ```

Pour les d√©ploiements SDK, les fichiers de configuration sont g√©n√©ralement servis depuis le m√™me serveur Tomcat ou plac√©s dans le r√©pertoire webapp.

<Callout emoji="‚ÑπÔ∏è" type="info">
    O3 charge les modules frontend √† la demande. Cela signifie que vous ne verrez les propri√©t√©s de configuration d'un module dans les outils de mise en ≈ìuvre que si le module lui-m√™me a √©t√© charg√©. Si vous ne voyez que des cl√©s par d√©faut comme "Display conditions" et "Translation overrides" dans un sch√©ma de configuration de module dans les outils de mise en ≈ìuvre, cela signifie que le module concern√© n'a probablement pas encore √©t√© charg√©.

    Pour voir la configuration des modules li√©s √† une fonctionnalit√© sp√©cifique, comme le panier de commandes, naviguez vers cette section de l'application (par exemple, le Dossier Patient). Une fois le module charg√©, vous verrez toutes ses propri√©t√©s configurables dans les outils de mise en ≈ìuvre.
</Callout>

**Configuration des extensions :**

Les extensions peuvent √©galement avoir leurs propres sch√©mas de configuration (s√©par√©s de leur module parent) et peuvent √™tre configur√©es par emplacement d'extension. Cela permet aux administrateurs de personnaliser le comportement des extensions diff√©remment pour chaque emplacement o√π elles apparaissent.

**Important** : La configuration des emplacements d'extensions est sp√©cifi√©e sous le **module qui poss√®de l'emplacement**, pas le module de l'extension. La configuration des extensions est sp√©cifi√©e en utilisant l'objet `extensionSlots` dans votre fichier de configuration :

```json
{
  "@openmrs/esm-my-module": {
    "extensionSlots": {
      "my-slot": {
        "add": ["extension-id"],
        "remove": ["other-extension-id"],
        "order": ["extension-1", "extension-2"],
        "configure": {
          "extension-id": {
            "customSetting": "value"
          }
        }
      }
    }
  }
}
```

Pour plus de d√©tails sur la configuration des extensions, consultez le guide [Syst√®me d'extensions](/docs/extension-system).

## Configuration au niveau de la distribution

Les impl√©menteurs peuvent configurer leurs instances au niveau de la distribution √† l'aide des approches suivantes :

### distro.properties

Le fichier `distro.properties` est un fichier de configuration qui d√©crit les modules backend qui constituent votre distribution. Le fichier distro.properties par d√©faut de l'application de r√©f√©rence se trouve [ici](https://github.com/openmrs/openmrs-distro-referenceapplication/blob/main/distro/distro.properties). Les √©l√©ments les plus importants √† inclure dans le distro.properties sont :

- `war.openmrs` - la version de Core utilis√©e.
- Pour chaque module, nous aurons g√©n√©ralement une entr√©e stylis√©e comme `omod.[module-id] = [module-version]`. Par exemple, `omod.referenceapplication = 2.11.0`.
- Les packages de contenu sont r√©f√©renc√©s en utilisant le pr√©fixe `content.`. Par exemple, `content.referenceapplication = 1.5.0-SNAPSHOT` r√©f√©rence le package de contenu de m√©tadonn√©es de base, et `content.referenceapplication-demo = 1.7.0-SNAPSHOT` r√©f√©rence le package de contenu de d√©monstration optionnel.

**Important** : Les modifications de `distro.properties` n√©cessitent une reconstruction du WAR backend pour prendre effet.

G√©n√©ralement, vous ne voudrez modifier le fichier `distro.properties` que si vous souhaitez sp√©cifier des modules backend ou des packages de contenu suppl√©mentaires que vous souhaitez inclure dans votre distribution. Si vous souhaitez supprimer un module backend de votre distribution, vous pouvez le faire en supprimant son entr√©e du fichier `distro.properties`.

#### D√©pendances backend

Les modules frontend d√©clarent leurs d√©pendances backend dans leurs fichiers `routes.json` en utilisant `backendDependencies` et `optionalBackendDependencies`. Ces d√©clarations sp√©cifient quels modules backend sont requis (ou optionnellement requis) pour que le module frontend fonctionne correctement.

**D√©pendances requises** (`backendDependencies`) : Modules backend qui doivent √™tre install√©s pour que le module frontend fonctionne. Si une d√©pendance requise est manquante ou a une version incompatible, le module frontend peut ne pas fonctionner correctement.

**D√©pendances optionnelles** (`optionalBackendDependencies`) : Modules backend qui activent des fonctionnalit√©s suppl√©mentaires s'ils sont pr√©sents. Les d√©pendances optionnelles peuvent √©galement activer des feature flags lorsqu'elles sont install√©es.

**V√©rification des d√©pendances manquantes** : Les outils de mise en ≈ìuvre v√©rifient automatiquement les d√©pendances backend et affichent des avertissements si :
- Des modules backend requis sont manquants
- Les modules backend install√©s ont des versions incompatibles
- Des modules backend optionnels qui activent des fonctionnalit√©s sont manquants

Pour v√©rifier les d√©pendances backend :
1. Ouvrez les outils de mise en ≈ìuvre (cliquez sur l'ic√¥ne de caret en bas de l'√©cran ou l'ic√¥ne d'engrenage dans la barre de navigation)
2. Naviguez vers l'onglet "Backend Modules"
3. Consultez la liste des modules et leur statut de d√©pendance

Si vous voyez des avertissements concernant des d√©pendances manquantes, vous devrez ajouter les modules backend requis √† votre fichier `distro.properties` et reconstruire votre WAR backend. Les outils de mise en ≈ìuvre vous montreront quels modules sont manquants et quelles versions sont requises.

### spa-assemble-config.json

Le fichier de configuration d'assemblage de la SPA d√©finit quels modules frontend sont inclus dans votre distribution et leurs versions. Ce fichier est utilis√© par la commande `assemble` pour g√©n√©rer la carte d'importation qui d√©termine quels modules sont charg√©s √† l'ex√©cution. Le fichier se trouve dans le r√©pertoire `frontend` de votre distribution. Le fichier spa-assemble-config de r√©f√©rence de l'application se trouve [ici](https://github.com/openmrs/openmrs-distro-referenceapplication/blob/main/frontend/spa-assemble-config.json).

**Important** : Les modifications de `spa-assemble-config.json` n√©cessitent une reconstruction de la SPA frontend pour prendre effet. L'objet `frontendModules` est la source de v√©rit√© pour quels modules sont charg√©s‚Äîseuls les modules list√©s ici seront disponibles dans votre application.

Le fichier de configuration d'assemblage de la SPA contient :

- `frontendModules` - un objet qui d√©crit toutes les applications qui constituent votre distribution et leurs versions sp√©cifiques (telles que publi√©es sur un registre NPM). Les cl√©s sont des noms de modules (par exemple, `@openmrs/esm-patient-chart-app`) et les valeurs sont des cha√Ænes de version (par exemple, `"4.3.1"` ou `"next"` pour les versions pr√©-release).
- `excludedFrontendModules` - (optionnel) un tableau de noms de modules √† exclure de la distribution.

Si vous souhaitez ajouter un nouveau module √† votre distribution, ajoutez-le √† l'objet `frontendModules`. Pour supprimer un module frontend, supprimez son entr√©e de l'objet `frontendModules`.

### spa-build-config.json

Le fichier de configuration de g√©n√©ration de la SPA sp√©cifie les propri√©t√©s de configuration √† l'ex√©cution pour votre application frontend. Ces propri√©t√©s sont int√©gr√©es dans l'application construite pendant le processus de construction. Le fichier se trouve dans le r√©pertoire `frontend` de votre distribution. Le fichier spa-build-config de r√©f√©rence de l'application se trouve [ici](https://github.com/openmrs/openmrs-distro-referenceapplication/blob/main/frontend/spa-build-config.json).

**Important** : Les modifications de `spa-build-config.json` n√©cessitent une reconstruction de la SPA frontend pour prendre effet. Cependant, de nombreuses propri√©t√©s peuvent √™tre remplac√©es √† l'ex√©cution en utilisant des variables d'environnement (voir les notes sp√©cifiques √† Docker ci-dessous).

Le fichier de configuration de g√©n√©ration de la SPA peut sp√©cifier les propri√©t√©s suivantes :

- `spaPath` - le chemin d'URL o√π votre SPA sera servi (peut √™tre remplac√© via la variable d'environnement `SPA_PATH`).
- `apiUrl` - l'URL du backend OpenMRS avec lequel votre SPA communiquera (peut √™tre remplac√© via la variable d'environnement `API_URL`). Par d√©faut : `/openmrs`.
- `configUrls` - un tableau d'URLs pointant vers des fichiers de configuration JSON qui seront charg√©s dans votre SPA √† l'ex√©cution (peut √™tre remplac√© via la variable d'environnement `SPA_CONFIG_URLS`). Ces URLs peuvent utiliser des variables de mod√®le comme `${openmrsSpaBase}` ou `${openmrsBase}` qui seront interpol√©es √† l'ex√©cution en utilisant la fonction `interpolateUrl()`. Par exemple, `${openmrsSpaBase}/config.json` sera r√©solu en `/openmrs/spa/config.json`.
- `defaultLocale` - la locale par d√©faut dans laquelle votre SPA sera servi (peut √™tre remplac√© via la variable d'environnement `SPA_DEFAULT_LOCALE`). Par d√©faut : `en_GB` (note : utilise un underscore, pas un tiret).
- `supportOffline` - valeur bool√©enne d√©terminant si votre SPA pourra fonctionner hors ligne ou non. Par d√©faut : `false`.
- `pageTitle` - le titre de page par d√©faut qui sera utilis√© par votre SPA. Par d√©faut : `OpenMRS`.
- `importmap` - URL ou chemin vers la carte d'importation (g√©n√©ralement `$SPA_PATH/importmap.json`).
- `routes` - URL ou chemin vers le registre des routes (g√©n√©ralement `$SPA_PATH/routes.registry.json`).

**Note sp√©cifique √† Docker** : L'application de r√©f√©rence utilise la substitution de variables d'environnement dans `spa-build-config.json` (par exemple, `$SPA_PATH`, `$SPA_CONFIG_URLS`). Celles-ci sont trait√©es au d√©marrage du conteneur par le script `startup.sh`, permettant des remplacements √† l'ex√©cution sans reconstruction. Vous pouvez les d√©finir dans la section environnement de votre `docker-compose.yml`.

## Guides de configuration suppl√©mentaires

Pour des t√¢ches de configuration sp√©cifiques, consultez ces guides d√©taill√©s :

- **[Configurer la marque](/docs/configure-o3/configure-branding)** - Personnaliser les logos, les couleurs et le favicon
- **[Configurer les traductions](/docs/configure-o3/configure-translations)** - Remplacer les traductions et ajouter de nouvelles locales
- **[Configurer le dossier patient](/docs/configure-o3/configure-the-patient-chart)** - Personnaliser les fonctionnalit√©s et extensions du dossier patient
- **[Configurer la gestion des patients](/docs/configure-o3/configure-patient-management)** - Personnaliser l'enregistrement, la recherche, les rendez-vous, les files d'attente, les salles et plus encore
- **[Configurer les files d'attente de service](/docs/configure-o3/configure-service-queues)** - Guide d√©taill√© pour la configuration des files d'attente de service
- **[Configurer la gestion des salles](/docs/configure-o3/configure-ward-management)** - Guide d√©taill√© pour la configuration de la gestion des salles
